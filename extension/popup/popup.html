<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAX Video Downloader</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body class="theme-dark">
    <header class="header">
        <nav class="tab-navigation">
            <button class="tab-button active" data-tab-id="videos-tab">
                Videos<span class="counter"></span>
            </button>
            <button class="tab-button" data-tab-id="downloads-tab">
                Downloads<span class="counter"></span>
            </button>
            <button class="tab-button" data-tab-id="settings-tab">Settings</button>
        </nav>
    </header>
    <main class="container">
        <section class="tab-contents">
            <div class="tab-content active" data-tab-id="videos-tab">
				<div class="controls">
					<!-- Filter Dropdown -->
					<div class="filter-dropdown" id="filter-dropdown">
						<button class="filter-btn rounded-btn" id="filter-btn">
							<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><rect x="2" y="3" width="12" height="1.5" rx="0.75" fill="currentColor"></rect><rect x="4" y="7" width="8" height="1.5" rx="0.75" fill="currentColor"></rect><rect x="6" y="11" width="4" height="1.5" rx="0.75" fill="currentColor"></rect></svg>
						</button>
						<div class="filter-options" id="filter-options">
							<!-- Sorting Options -->
							<div class="sort-controls">
								<button class="sort-btn active descending" id="sort-detection-time" data-sort="detection-time">
									Detected at
								</button>
								<button class="sort-btn" id="sort-duration" data-sort="duration">
									Duration
								</button>
								<button class="sort-btn" id="sort-title" data-sort="title">
									Title
								</button>
							</div>
							<div class="filter-options-separator"></div>
							
							<label class="filter-option">
								<input type="checkbox" value="hls" checked>
								<span>Show HLS</span>
							</label>
							<label class="filter-option">
								<input type="checkbox" value="dash" checked>
								<span>Show DASH</span>
							</label>
							<label class="filter-option">
								<input type="checkbox" value="direct" checked>
								<span>Show Direct</span>
							</label>
						</div>
					</div>
					
					<!-- Search Input -->
					<div class="search-container" id="search-container">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon" aria-hidden="true"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg>
						<input type="text" id="search-input" class="search-input" placeholder="Search">
						<button class="search-clear-btn" id="search-clear-btn" style="display: none;" aria-label="Clear search">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="18" y1="6" x2="6" y2="18"></line>
								<line x1="6" y1="6" x2="18" y2="18"></line>
							</svg>
						</button>
					</div>
					
					<!-- Clear Cache Button -->
					<button class="clear-cache-button rounded-btn" id="clear-cache-button" data-constraint="3 imgs = 8 KB">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2 lucide-trash-2 w-4 h-4" aria-hidden="true"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line></svg>
					</button>
				</div>
                <section id="videos-list" class="videos-container">
                    <!-- HLS Group -->
                    <div class="video-type-group" data-video-type="hls" style="display: none;">
                        <div class="section-header collapsible">
                            <h2 class="section-title">HLS Streams<span class="counter"></span></h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content">
                            <!-- Video items populated here -->
                        </div>
                    </div>
                    
                    <!-- DASH Group -->
                    <div class="video-type-group" data-video-type="dash" style="display: none;">
                        <div class="section-header collapsible">
                            <h2 class="section-title">DASH Streams<span class="counter"></span></h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content">
                            <!-- Video items populated here -->
                        </div>
                    </div>
                    
                    <!-- Direct Video Group -->
                    <div class="video-type-group" data-video-type="direct" style="display: none;">
                        <div class="section-header collapsible">
                            <h2 class="section-title">Direct Videos<span class="counter"></span></h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content">
                            <!-- Video items populated here -->
                        </div>
                    </div>
                    
                    <!-- Unknown Video Group -->
                    <div class="video-type-group" data-video-type="unknown" style="display: none;">
                        <div class="section-header collapsible">
                            <h2 class="section-title">Other Videos<span class="counter"></span></h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content">
                            <!-- Video items populated here -->
                        </div>
                    </div>
                    
                    <div class="initial-message">
                        <div class="no-videos-message">
                            <p>No videos found on the page.</p>
                            <p>Play a video or Refresh the page.</p>
                        </div>
                        <div class="no-matches-message">
                            <p>No matches found.</p>
                            <p>Try different search terms.</p>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="tab-content" data-tab-id="downloads-tab">
                <section class="downloads-container">
                    <div class="active-downloads-section">
                        <div class="section-header collapsible">
                            <h2 class="section-title">Active & Queued</h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content active-downloads">
                            <div class="initial-message">
                                <p>Ongoing downloads will appear here</p>
                            </div>
                        </div>
                    </div>
                    <div class="downloads-history-section">
                        <div class="section-header collapsible">
                            <h2 class="section-title">History<span class="counter"></span></h2>
                            <div class="toggle-icon">
                                <svg width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M1.70833 3.125C1.31771 2.73438 0.683333 2.73438 0.292708 3.125C-0.0979167 3.51562 -0.0979167 4.15 0.292708 4.54062L4.29271 8.54062C4.68333 8.93125 5.31771 8.93125 5.70833 8.54062L9.70833 4.54062C10.099 4.15 10.099 3.51562 9.70833 3.125C9.31771 2.73438 8.68333 2.73438 8.29271 3.125L5 6.41875L1.70833 3.125Z"/>
                                </svg>
                            </div>
                        </div>
                        <div class="section-content downloads-history">
                            <div class="initial-message">
                                <p>You don't have any downloads in history</p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            
            <div class="tab-content" data-tab-id="settings-tab">
				<section class="settings-container">
            	<h1 class="app-title">MAX Video Downloader</h1>
				
					<!-- Native Host Connection Section -->
					<div class="settings-section">
						<div class="status-info">
							<div class="status-line">
								<span class="status-label">Status:</span>
								<div class="status-value">
									<div class="status-dot disconnected" id="connection-status-dot"></div>
									<span id="connection-status-text">Checking...</span>
									<span id="connection-version"></span>
									<button type="button" class="reconnect-icon hidden" id="reconnect-icon" title="Reconnect">
										<svg width="10" height="10" viewBox="0 0 24 24" fill="none">
											<path d="M1 4v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
											<path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
										</svg>
									</button>
								</div>
							</div>
							<div class="status-line" id="connection-location-line" style="display: none;">
								<span class="status-label">Location:</span>
								<span class="status-value" id="connection-location"></span>
							</div>
							<div class="status-line" id="connection-ffmpeg-line" style="display: none;">
								<span class="status-label">FFmpeg:</span>
								<span class="status-value" id="connection-ffmpeg"></span>
							</div>
						</div>
						<div class="status-actions hidden" id="status-actions">
							<button type="button" class="action-button primary" id="reconnect-button" disabled>
								<svg width="12" height="12" viewBox="0 0 24 24" fill="none">
									<path d="M1 4v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									<path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								</svg>
								Reconnect
							</button>
							<button type="button" class="action-button" id="download-button">
								<svg width="12" height="12" viewBox="0 0 24 24" fill="none">
									<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									<polyline points="7,10 12,15 17,10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									<line x1="12" y1="15" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								</svg>
								Download
							</button>
							<button type="button" class="action-button" id="help-button">
								<svg width="12" height="12" viewBox="0 0 24 24" fill="none">
									<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
									<path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
									<path d="M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
								</svg>
								Help
							</button>
						</div>
					</div>
					
					<!-- Appearance Settings Section -->
                    <div class="settings-section">
                        <div class="input-group horizontal">
                            <label class="input-label">
                                Theme
                                <div class="tooltip-icon" data-tooltip="Choose your preferred theme">?</div>
                            </label>
                            <div class="input-container">
                                <div class="unit-toggle" data-setting="theme" data-unit-toggle="theme">
                                    <div class="unit-option active" data-value="dark">Dark</div>
                                    <div class="unit-option" data-value="light">Light</div>
                                </div>
                            </div>
                        </div>
					</div>
					
					<!-- Downloads Settings Section -->
					<div class="settings-section">
						<div class="input-group horizontal">
							<label class="input-label">
								Concurrent Downloads
								<div class="tooltip-icon" data-tooltip="Maximum number of simultaneous downloads">?</div>
							</label>
							<div class="input-container">
								<div class="input-constraint-wrapper" data-constraint="1-10">
									<input 
										type="number" 
										data-setting="maxConcurrentDownloads"
										class="input-field" 
										min="1" 
										max="10" 
										value="1"
										placeholder="1"
									/>
								</div>
							</div>
						</div>
						
						<div class="input-group horizontal path-input-group">
							<label class="input-label">
								Default Save Path
								<div class="tooltip-icon" data-tooltip="Default folder for saving downloaded videos">?</div>
							</label>
							<div class="input-container">
								<div class="input-constraint-wrapper" data-constraint="Do not choose root folders!">
									<input 
										type="text" 
										data-setting="defaultSavePath"
										class="input-field path-input clickable" 
										readonly
										placeholder="Click to choose folder"
									/>
								</div>
							</div>
						</div>
						
						<div class="input-group horizontal">
							<label class="input-label">
								Show Download Notifications
								<div class="tooltip-icon" data-tooltip="Show system notifications when downloads start and complete">?</div>
							</label>
							<label class="toggle-switch">
								<input 
									type="checkbox" 
									data-setting="showDownloadNotifications"
									checked
								/>
								<span class="toggle-slider"></span>
							</label>
						</div>
					</div>

					<!-- Detection Settings Section -->
					<div class="settings-section">
						<div class="input-group horizontal">
							<label class="input-label">
								Min. File Size
								<div class="tooltip-icon" data-tooltip="Skip video files smaller than this size">?</div>
							</label>
							<div class="input-container">
								<div class="unit-input-group">
									<div class="unit-toggle" data-unit-toggle="minFileSizeFilter">
										<button type="button" class="unit-option active" data-multiplier="1024">KB</button>
										<button type="button" class="unit-option" data-multiplier="1048576">MB</button>
									</div>
									<div class="input-constraint-wrapper" data-constraint="Max: 100 MB">
										<input 
											type="number" 
											data-setting="minFileSizeFilter"
											class="input-field unit-number-input" 
											min="0" 
											max="102400"
											step="0.01"
											value="100"
											placeholder="100"
										/>
									</div>
								</div>
							</div>
						</div>
						
						<div class="input-group horizontal">
							<label class="input-label">
								Auto-Generate Previews
								<div class="tooltip-icon" data-tooltip="Automatically generate video thumbnails for detected videos">?</div>
							</label>
							<label class="toggle-switch">
								<input 
									type="checkbox" 
									data-setting="autoGeneratePreviews"
									checked
								/>
								<span class="toggle-slider"></span>
							</label>
						</div>
					</div>

					<!-- History Settings Section -->		
					<div class="settings-section">
						<div class="input-group horizontal">
							<label class="input-label">
								Save Downloads in History
								<div class="tooltip-icon" data-tooltip="Save completed downloads to history for tracking">?</div>
							</label>
							<label class="toggle-switch">
								<input 
									type="checkbox" 
									data-setting="saveDownloadsInHistory"
									checked
								/>
								<span class="toggle-slider"></span>
							</label>
						</div>
						
						<div class="input-group horizontal">
							<label class="input-label">
								Max. History Items
								<div class="tooltip-icon" data-tooltip="Maximum number of download history items to keep">?</div>
							</label>
							<div class="input-container">
								<div class="input-constraint-wrapper" data-constraint="0-200">
									<input 
										type="number" 
										data-setting="maxHistorySize"
										class="input-field" 
										min="0" 
										max="200"
										value="50"
										placeholder="50"
									/>
								</div>
							</div>
						</div>
						
						<div class="input-group horizontal">
							<label class="input-label">
								Auto-Remove After (Days)
								<div class="tooltip-icon" data-tooltip="Automatically remove history items older than this many days">?</div>
							</label>
							<div class="input-container">
								<div class="input-constraint-wrapper" data-constraint="1-365">
									<input 
										type="number" 
										data-setting="historyAutoRemoveInterval"
										class="input-field" 
										min="1" 
										max="365"
										value="30"
										placeholder="30"
									/>
								</div>
							</div>
						</div>
					</div>
				</section>
            </div>
        </section>
    </main>
    <div id="preview-hover" class="preview-hover">
        <img id="hover-preview-img" alt="Full preview">
    </div>
    <script type="module" src="index.js"></script>
</body>
</html>